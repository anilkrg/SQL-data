
CREATE TABLE DEPARTMENT
(DEPT_ID INT PRIMARY KEY IDENTITY,
NAME VARCHAR(MAX),
DEPART VARCHAR(MAX)
);

CREATE TABLE EMPLOYEE
(EMP_ID INT PRIMARY KEY IDENTITY,
NAME VARCHAR(MAX),
EMAIL VARCHAR(MAX),
ADDRESS VARCHAR(MAX),
GENDER VARCHAR(20),
MOBILE VARCHAR(20),
DEPARTMENT_ID INT FOREIGN KEY REFERENCES DEPARTMENT(DEPT_ID)
);


SELECT * FROM DEPARTMENT
SELECT * FROM EMPLOYEE


EXEC SP_DEPARTMENT 'SELECT'
EXEC SP_DEPARTMENT 'CREATE',0,'GAURAV','SALES'



CREATE PROC SP_DEPARTMENT
@ACTION VARCHAR(20),
@DEPT_ID INT=0,
@NAME VARCHAR(100)=NULL,
@DEPART VARCHAR(100)=NULL
AS
BEGIN
IF(@ACTION='CREATE')
BEGIN	
	INSERT INTO DEPARTMENT(NAME,DEPART)VALUES(@NAME,@DEPART)
	SELECT 1 AS RESULT
END
ELSE IF(@ACTION='DELETE')
BEGIN
	DELETE FROM DEPARTMENT WHERE DEPT_ID=@DEPT_ID
	SELECT 1 AS RESULT
END
ELSE IF(@ACTION='SELECT')
BEGIN
	SELECT * FROM DEPARTMENT
	END
ELSE IF(@ACTION='UPDATE')
BEGIN
	UPDATE DEPARTMENT SET NAME=@NAME,DEPART=@DEPART WHERE DEPT_ID=@DEPT_ID
	SELECT 1 AS RESULT
	END
END

ALTER SP_EMPLOYEE

CREATE PROC SP_EMPLOYEE
@ACTION VARCHAR(20),
@EMP_ID INT=0,
@NAME VARCHAR(100)=NULL,
@EMAIL VARCHAR(100)=NULL,
@ADDRESS VARCHAR(100)=NUL,
@GENDER VARCHAR(100)=NULL,
@MOBILE VARCHAR(100)=NULL,
@DEPARTMENT_ID INT=0
AS
BEGIN
IF(@ACTION='CREATE')
BEGIN	
	INSERT INTO EMPLOYEE(NAME,EMAIL,ADDRESS,GENDER,MOBILE,DEPARTMENT_ID)VALUES(@NAME,@EMAIL,@ADDRESS,@GENDER,@MOBILE,@DEPARTMENT_ID)
	SELECT 1 AS RESULT
END
ELSE IF(@ACTION='DELETE')
BEGIN
DELETE FROM EMPLOYEE WHERE EMP_ID=@EMP_ID
SELECT 1 AS RESULT
END
ELSE IF(@ACTION='SELECT')
BEGIN
SELECT * FROM EMPLOYEE
END
ELSE IF(@ACTION='SELECT_JOIN')
BEGIN
SELECT E.EMP_ID,E.NAME,E.EMAIL,E.ADDRESS,E.GENDER,E.MOBILE,D.NAME 
FROM EMPLOYEE E
FULL OUTER JOIN
DEPARTMENT D
ON E.DEPARTMENT_ID=D.DEPT_ID
END
ELSE IF(@ACTION='UPDATE')
BEGIN
UPDATE EMPLOYEE SET NAME=@NAME,EMAIL=@EMAIL, ADDRESS=@ADDRESS, GENDER=@GENDER, MOBILE=@MOBILE, DEPARTMENT_ID=@DEPARTMENT_ID WHERE EMP_ID=@EMP_ID;
SELECT 1 AS RESULT
END
END

EXEC SP_EMPLOYEE 'SELECT'
EXEC SP_EMPLOYEE'SELECT_JOIN'
EXEC SP_EMPLOYEE 'DELETE',5


EXEC SP_EMPLOYEE 'CREATE',0,'ARJUN','ARJUN@GMAIL.COM','DELHI','MALE',9874885994,2;
DROP PROCEDURE IF EXISTS [SP_EMPLOYEE]
